<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>DSSC  Unmul | Model Development and Evaluation</title>
    <meta name="author" content="DSSC  Unmul" />
    <meta name="description" content="Official website Data Science Study Club Unmul
" />
    <meta name="keywords" content="data-science, study-club" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📊</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://dssc-unmul.github.io//learning/05_model_development/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    


    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Distill js -->
    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    
  </head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Model Development and Evaluation",
      "description": "",
      "published": "August 21, 2022",
      "authors": [
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body class="fixed-top-navsticky-bottom-footer">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://dssc-unmul.github.io//"><span class="font-weight-bold">DSSC</span>   Unmul</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/learning/">learning</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/publications/">publications</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/projects/">projects</a>
                </div>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1>Model Development and Evaluation</h1>
        <p></p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        <d-contents>
          <nav class="l-text figcaption">
          <h3>Contents</h3>
            <div><a href="#model-development">Model Development</a></div>
            <ul>
              <li><a href="#simple-dan-multiple-linear-regression">Simple dan Multiple Linear Regression</a></li>
              <li><a href="#r-squared-dan-mse-untuk-in-sample-evaluation">R-Squared dan MSE untuk In-Sample Evaluation</a></li>
              <li><a href="#model-evaluation-dengan-visualisasi">Model Evaluation dengan Visualisasi</a></li>
              <li><a href="#prediction-dan-decision-making">Prediction dan Decision Making</a></li>
              
            </ul>
<div><a href="#model-evaluation-and-refinement">Model Evaluation and Refinement</a></div>
            
          </nav>
        </d-contents>

        <h1 id="model-development">Model Development</h1>

<p>Kita telah menentukan variabel mana yang bagus mana yang jelek. Kita juga sudah membersihkan data sehingga akhirnya siap untuk digunakan dalam pengembangan model. Sekarang saatnya kita memprediksi harga mobil berdasarkan data yang ada.</p>

<p>Buka hands-on di <a href="https://github.com/dssc-unmul/data-analysis/blob/main/Model-Development.ipynb" target="_blank" rel="noopener noreferrer">github</a> atau langsung buka di colab <a href="https://colab.research.google.com/github/dssc-unmul/data-analysis/blob/main/Model-Development.ipynb" target="_blank" rel="noopener noreferrer"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Buka di Colab"></a></p>

<h2 id="simple-dan-multiple-linear-regression">Simple dan Multiple Linear Regression</h2>

<ul>
  <li>(Simple) Linear regression mengacu pada satu variabel independen untuk membuat prediksi</li>
  <li>Multiple linear regression mengacu pada <strong>lebih dari satu</strong> variabel independen untuk membuat prediksi</li>
</ul>

<h3 id="simple-linear-regression">Simple Linear Regression</h3>

<p>Ini hanya untuk dua variabel saja, satu prediktor satu target.</p>

\[Y=a+bX\]

<p>Dimana:</p>

<ul>
  <li>\(a\): intersep (nilai ketika x=0)</li>
  <li>\(b\): slope (kemiringan garis/gradien)</li>
</ul>

<h4 id="prediction">Prediction</h4>

<p>Anggaplah <code class="language-plaintext highlighter-rouge">highway-mpg</code> punya relasi linear dengan <code class="language-plaintext highlighter-rouge">price</code>.</p>

<p><img src="/assets/img/prediction.png" alt=""></p>

<p>Jika <code class="language-plaintext highlighter-rouge">highway</code>-nya 20 maka pricenya sekian.</p>

<h4 id="fitting">Fitting</h4>

<p>Nah untuk membuat garisnya. Diambil titik data untuk di latih (<em>fit</em>).</p>

<p><img src="/assets/img/fit.png" alt=""></p>

<p>Hasil dari fitting adalah parameter \((a,b)\).</p>

<p>Titik data disimpan dalam numpy array. Array <code class="language-plaintext highlighter-rouge">y</code> untuk target, array <code class="language-plaintext highlighter-rouge">x</code> untuk predictor.</p>

<p>Banyak faktor yang dapat mempengaruhi prediksi. Ketidakpastian ini disertakan dengan mengasumsikan nilai acak kecil ditambahkan pada titik data di garis regresi. Inilah yang disebut <em>noise</em>.</p>

<p><img src="/assets/img/distribution-of-noise.png" alt=""></p>

<p>Gambar di atas adalah distribusi noisenya</p>

<ul>
  <li>Sumbu vertikal menunjukkan value yang ditambahkan</li>
  <li>Sumbu horizontal mengilustrasikan kemungkinan value tersebut akan ditambahkan</li>
</ul>

<h4 id="wrap-up">Wrap Up</h4>

<ul>
  <li>Kita punya training point (titik data untuk dilatih)</li>
  <li>Kemudian di train</li>
  <li>Menghasilkan parameter \((a,b)\)</li>
  <li>Gunakan parameternya untuk model \(\hat{Y}=a+bX\)</li>
</ul>

<p>Jika masih penasaran dengan cara kerja linear regression, video dibawah mungkin bisa membantu</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/nk2CQITm_eo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<h4 id="fitting-a-simple-linear-model-estimator">Fitting a Simple Linear Model Estimator</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</code></pre></div></div>

<p>Kemudian bikin objek</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lm</span> <span class="o">=</span> <span class="n">LinearRegression</span>
</code></pre></div></div>

<p>Tentukan variabel prediktor dan target nya</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">'highway-mpg'</span><span class="p">]]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'price'</span><span class="p">]</span>
</code></pre></div></div>

<p>Kemudian <em>fit the model</em></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lm</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
</code></pre></div></div>

<p>Sekarang kita bisa memperoleh prediksi</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Yhat</span> <span class="o">=</span> <span class="n">lm</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_predictor</span><span class="p">)</span>
</code></pre></div></div>

<p>\(a\) dan \(b\) dapat diakses sebagai atribut.</p>

<h3 id="multiple-linear-regression">Multiple Linear Regression</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Z</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">'horsepower'</span><span class="p">,</span> <span class="s">'curb-weight'</span><span class="p">,</span> <span class="s">'engine-size'</span><span class="p">,</span> <span class="s">'highway-mpg'</span><span class="p">]]</span>
<span class="n">lm</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s">'price'</span><span class="p">])</span>

<span class="n">Yhat</span> <span class="o">=</span> <span class="n">lm</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_predictor</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="model-evaluation-dengan-visualisasi">Model Evaluation dengan Visualisasi</h2>

<h3 id="regression-plot">Regression Plot</h3>

<p>Kenapa pakai regression plot?. Karena bisa memberi estimasi yang bagus pada:</p>
<ul>
  <li>Relasi antara dua variabel</li>
  <li>Tingkat korelasi</li>
  <li>Arah relasi (positif atau negatif)</li>
</ul>

<p>Regression plot dapat menampilkan kombinasi dari scatter plot dan garis regresi linear yang sudah dilatih. Garis regresi linear merepresentasikan nilai yang diprediksi.</p>

<p>Cara menggunakannya</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="p">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"highway-mpg"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"price"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/img/2022-08-03-23-59-21.png" alt=""></p>

<h3 id="residual-plot">Residual Plot</h3>

<p>Residual plot merepresentasikan error antara nilai aktualnya.</p>

<p>Kurangkan nilai actualnya dengan nilai predicted-nya sehingga dapat nilai error. Kemudian plot kembali hasilnya.</p>

<p><img src="/assets/img/how-residual-plot-work.png" alt=""></p>

<p>Hasil yang diinginkan adalah plot nya (titik-titiknya) tersebar secara random disekitar sumbu x.</p>

<p><img src="/assets/img/good-residual-plot.png" alt=""></p>

<p>Ini berarti linear modelnya bagus.</p>

<p><img src="/assets/img/residual-plot-curvature.png" alt=""></p>

<p>Disini plotnya membentuk kurva, tidak tersebar secara random. Mungkin lebih baik menggunakan nonlinear model.</p>

<p><img src="/assets/img/residual-plot-increasing-variance.png" alt=""></p>

<p>Disini variance dari residualnya meningkat dengan x. Maka model nya salah</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="n">sns</span><span class="p">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'highway-mpg'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s">'price'</span><span class="p">])</span>
</code></pre></div></div>

<h3 id="distribution-plot">Distribution plot</h3>

<p>Distribution plot menghitung nilai actual versus nilai predicted.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'price'</span><span class="p">],</span> <span class="n">hist</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"r"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Actual value'</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">Yhat</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Fitted Values'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="/assets/img/distribution-plot.png" alt=""></p>

<h2 id="polynomial-regression-dan-pipelines">Polynomial Regression dan Pipelines</h2>

<h3 id="polynomial-regression">Polynomial regression</h3>

<p>Bagaimana jika linear regression bukan model yang tepat. Kita ubah data kita menjadi <a href="https://id.wikipedia.org/wiki/Polinomial" target="_blank" rel="noopener noreferrer">polinomial</a> (suku banyak) kemudian gunakan linear regression untuk melatih parameter</p>

<p><a title="Gisling, CC BY-SA 4.0 &lt;https://creativecommons.org/licenses/by-sa/4.0&gt;, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:Chebyshev_polynomial.gif" target="_blank" rel="noopener noreferrer"><img width="300" alt="Chebyshev polynomial" src="https://upload.wikimedia.org/wikipedia/commons/5/56/Chebyshev_polynomial.gif"></a></p>

<p>Polynomial regression berguna untuk relasi yang berbentuk kurva (<em>curvilinier relationship</em>). Curvilinier relationship didapat dari mengkuadratkan atau menetapkan derajat suku tinggi ke variabel prediktor. Berarti harus transforming data.</p>

<p>Walaupun variabel prediktor dari Polynomial Regression tidak linear, hubungan antara parameter atau koefisien nya tetap linear.</p>

<h4 id="macam-macam-polynomial-regression">Macam-macam polynomial regression</h4>

<ul>
  <li>Quadratic - derajat 2
    <ul>
      <li>
\[\hat{Y}=b_0+b_1x_1+b_2(x_1)^2\]

        <p><a title="Original hand-drawn version: N.MoriUpdated hand-drawn version: Rubber Duck (☮ • ✍), Public domain, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:Polynomialdeg2.svg" target="_blank" rel="noopener noreferrer"><img width="256" alt="Polynomialdeg2" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Polynomialdeg2.svg/256px-Polynomialdeg2.svg.png"></a></p>
      </li>
    </ul>
  </li>
  <li>Cubic - derajat 3
    <ul>
      <li>
\[\hat{Y}=b_0+b_1x_1+b_2(x_1)^2+b_3(x_1)^3\]

        <p><a title="N.Mori, Public domain, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:Polynomialdeg3.svg" target="_blank" rel="noopener noreferrer"><img width="256" alt="Polynomialdeg3" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a3/Polynomialdeg3.svg/256px-Polynomialdeg3.svg.png"></a></p>
      </li>
    </ul>
  </li>
  <li>Derajat tinggi
    <ul>
      <li>
\[\hat{Y}=b_0+b_1x_1+b_2(x_1)^2+b_3(x_1)^3+...\]

        <p><a title="Geek3, CC BY-SA 3.0 &lt;https://creativecommons.org/licenses/by-sa/3.0&gt;, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:Polynomialdeg5.svg" target="_blank" rel="noopener noreferrer"><img width="256" alt="Polynomialdeg5" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Polynomialdeg5.svg/128px-Polynomialdeg5.svg.png"></a></p>
      </li>
    </ul>
  </li>
</ul>

<h4 id="implementasi-di-python">Implementasi di Python</h4>

<p>Menghitung polynomial derajat 3</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></div>

\[-1.557(x_1)^3+204.8(x_1)^+8965x_1+1.37\times{10^5}\]

<p>Dimensi banyak</p>

\[\hat{Y} = b_0 + b_1 X_1 + b_2 X_2 + b_3 X_1 X_2 + b_4 (X_1)^2 + b_5(X_2)^2 + \dots\]

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>

<span class="n">pr</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">x_polly</span> <span class="o">=</span> <span class="n">pr</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">[[</span><span class="s">'horsepower'</span><span class="p">,</span> <span class="s">'curb-weight'</span><span class="p">]])</span>
</code></pre></div></div>

<h4 id="pre-processing">Pre-processing</h4>

<p>Semakin besar dimensinya (variabel yang digunakan), kita mungkin mau menormalisasikan fitur-fitur (variabel) nya sekaligus.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scale</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">[[</span><span class="s">'horsepower'</span><span class="p">,</span> <span class="s">'highway-mpg'</span><span class="p">]])</span>

<span class="n">x_scale</span> <span class="o">=</span> <span class="n">scale</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_data</span><span class="p">[[</span><span class="s">'horsepower'</span><span class="p">,</span> <span class="s">'highway-mpg'</span><span class="p">]])</span>
</code></pre></div></div>

<h3 id="pipeline">Pipeline</h3>

<p>Pipeline digunakan untuk menyederhanakan proses</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="c1"># buat list of tuple
# elemen pertama adalah namanya
# elemen kedua adalah constructornya
</span><span class="nb">input</span> <span class="o">=</span> <span class="p">[(</span><span class="s">'scale'</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s">'polynomial'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span> <span class="p">...,</span> <span class="p">(</span><span class="s">'model'</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())]</span>

<span class="c1">#pipline constructor
</span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>

<span class="c1"># we can train the pipeline object
</span><span class="n">pipe</span><span class="p">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="p">[[</span><span class="s">'horsepower'</span><span class="p">,</span> <span class="s">'highway-mpg'</span><span class="p">,</span> <span class="s">'curb-weight'</span><span class="p">,</span> <span class="s">'engine-size'</span><span class="p">]],</span> <span class="n">y</span><span class="p">)</span>
<span class="n">yhat</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[[</span><span class="s">'horsepower'</span><span class="p">,</span> <span class="s">'highway-mpg'</span><span class="p">,</span> <span class="s">'curb-weight'</span><span class="p">,</span> <span class="s">'engine-size'</span><span class="p">]])</span>
</code></pre></div></div>

<p>Metode ini menormalisasi data, transformasi polinomial, dan menghasilkan prediksi.</p>

<h2 id="r-squared-dan-mse-untuk-in-sample-evaluation">R-Squared dan MSE untuk In-Sample Evaluation</h2>

<p>Pengukuran ini adalah salah satu cara untuk mengukur secara numerik seberapa bagus modelnya untuk dataset. Ada dua metrik pengukur penting:</p>

<ul>
  <li><a href="https://id.wikipedia.org/wiki/Rata-rata_kuadrat_galat" target="_blank" rel="noopener noreferrer">Mean Squared Error (MSE)</a></li>
  <li><a href="https://en.wikipedia.org/wiki/Coefficient_of_determination" target="_blank" rel="noopener noreferrer">R-Squared</a></li>
</ul>

<h3 id="mean-squared-error-mse">Mean Squared Error (MSE)</h3>

<p>Langkahnya:</p>

<ol>
  <li>Selisihkan nilai asli dan predicted nya</li>
  <li>Pangkatkan 2</li>
  <li>Tambahkan dengan nilai-nilai yang lain</li>
  <li>Bagi sejumlah banyak nilai-nilainya</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'price'</span><span class="p">],</span> <span class="n">Y_predict_simple_fit</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="r-squared">R-Squared</h3>

<p>Disebut juga <em>Coefficient of Determination</em> adalah pengukuran untuk menentukan seberapa dekat data dengan garis regresi.</p>

\[R^2=1-\frac{MSE\ of\ regression\ line}{MSE\ of\ the\ average\ of\ the\ data}\]

<p>1 artinya bagus, 0 jelek</p>

<p><img src="/assets/img/r_squared_graphs.png" alt=""></p>

<ul>
  <li>Garis biru merepresentasikan garis regresi</li>
  <li>Kotak biru menunjukkan MSE dari garis regresi</li>
  <li>garis merah menunjukkan rata-rata nilai dari titik data</li>
  <li>Kotak merah menunjukkan MSE dari garis merah</li>
  <li>Bisa dilihat kotak biru lebih kecil daripada kotak merah</li>
</ul>

<p>R-Squared di python dapat diakses dari atribut <code class="language-plaintext highlighter-rouge">score</code> model object setelah di <code class="language-plaintext highlighter-rouge">fit</code></p>

<h2 id="prediction-dan-decision-making">Prediction dan Decision Making</h2>

<h3 id="prediction-1">Prediction</h3>

<p>Prediksi bisa dilakukan dengan memasukkan nilai X yang mau diprediksi ke dalam method <code class="language-plaintext highlighter-rouge">predict</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">yhat</span><span class="o">=</span><span class="n">lm</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_input</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="menentukan-model-yang-bagus">Menentukan Model yang Bagus</h3>

<p>Supaya tau model ini adalah best fit, lihat:</p>

<ul>
  <li>Nilai yang diprediksi makes sense, misalnya nilai nya tidak negatif</li>
  <li><a href="#model-evaluation-dengan-visualisasi">Visualisasinya</a></li>
  <li><a href="#r-squared-dan-mse-untuk-in-sample-evaluation">Pengukuran numerik untuk evaluasi</a></li>
  <li>Membandingkan antara model yang berbeda
    <ul>
      <li>Apakah <a href="#mean-squared-error-mse">MSE</a> yang lebih rendah selalu mengindikasikan model lebih baik? Belum tentu</li>
      <li>MSE untuk model <a href="#multiple-linear-regression">Multiple Linear Regression</a> akan selalu lebih kecil daripada MSE untuk <a href="#simple-linear-regression">Simple Linear Regression</a>. Karena error pada data akan berkurang ketika lebih banyak variabel yang dimasukkan ke dalam model</li>
      <li>
<a href="#polynomial-regression">Polynomial Regression</a> juga akan punya MSE yang rendah daripada linear regression biasa</li>
      <li>Hubungan kebalikannya yang serupa juga berlaku untuk R-Squared</li>
    </ul>
  </li>
</ul>

<h1 id="model-evaluation-and-refinement">Model Evaluation and Refinement</h1>

<p>Evaluasi model dibutuhkan untuk mengukur akurasi. Akurasi model dapat ditingkatkan dengan banyak metode.</p>

<p>Buka hands-on model evaluation di <a href="https://github.com/dssc-unmul/data-analysis/blob/main/Model-Evaluation.ipynb" target="_blank" rel="noopener noreferrer">github</a> atau langsung buka di colab <a href="https://colab.research.google.com/github/dssc-unmul/data-analysis/blob/main/Model-Evaluation-and-Refinement.ipynb" target="_blank" rel="noopener noreferrer"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Buka di Colab"></a></p>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

    </div>

    <!-- Footer -->    <footer class="sticky-bottom mt-5">
      <div class="container">
        © Copyright 2022 DSSC  Unmul. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.
Last updated: August 21, 2022.
      </div>
    </footer>

  </body>

  <d-bibliography src="/assets/bibliography/">
  </d-bibliography>

  <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

  <script src="/assets/js/distillpub/overrides.js"></script>

</html>
